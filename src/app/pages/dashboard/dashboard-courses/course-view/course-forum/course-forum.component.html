<div class="min-h-screen bg-custom-background dark:bg-transparent">
  <div class="fixed top-0 right-0 flex justify-end p-5 pointer-events-auto">
    <button
      class="px-6 py-3 text-xl text-black rounded-full border border-custom-accent-dark bg-custom-primary-dark hover:bg-custom-accent-dark dark:bg-purple-100 dark:hover:bg-purple-900 dark:border-purple-900 transition-all duration-300 transform hover:scale-105 hover:text-white shadow-lg hover:shadow-3xl"
      (click)="showThreadForm = true"
    >
      Crear hilo
    </button>
  </div>
  <div class="fixed top-1/2 right-0 flex justify-end p-5 pointer-events-auto">
    <button
      class="p-2 text-xl text-black rounded-full w-10 h-10 bg-custom-background dark:bg-transparent dark:shadow-sm dark:shadow-white hover:bg-custom-primary dark:bg-purple-100 dark:hover:bg-purple-900 dark:border-purple-900 transition-all duration-300 transform hover:scale-105 hover:text-white shadow-lg hover:shadow-3xl"
      (click)="toggleOrder(); updateForum()"
    >
      <img
        [src]="order === 'desc' ? `down_arrow${isDarkMode() ? '_light' : ''}.svg` : `up_arrow${isDarkMode() ? '_light' : ''}.svg`"
        [alt]="order === 'desc' ? 'Icono de orden decreciente' : 'Icono de orden creciente'"
        class=""
      />
    </button>
  </div>
  @for (thread of forum; track thread.uuid) {
    <app-thread
      [thread]="thread"
      [token]="token"
      [threadUuidWhereAResponseIsBeingCreated]="threadUuidWhereAResponseIsBeingCreated"
      [threadUuidWhereAResponseIsBeingEdited]="threadUuidWhereAResponseIsBeingEdited"
      [user]="user"
      [course_uuid]="course_uuid"
      (update)="updateForum()"
      (delete)="updateForum()"
      (answeredThread)="onThreadAnswered($event)"
      (editedThread)="onThreadEdited($event)"
    ></app-thread>
  }
  @if (showThreadForm) {
    <div class="absolute inset-0 p-5 md:p-20 bg-black/30 z-50 flex justify-center">
      <app-thread-form
        [thread]="{
          uuid: '',
          user: {
            uuid: user.uuid,
            first_name: user.first_name,
            last_name: user.last_name,
            profile_image_url: user.profile_image_url ? user.profile_image_url : '',
            role: user.role === 'general' ? 'student' : 'teacher',
          },
          title: '',
          content: '',
          created_at: '',
          updated_at: '',
          responses: [],
        }"
        [course_uuid]="course_uuid"
        [type]="'create'"
        (cancel)="showThreadForm = false"
        (create)="showThreadForm = false; updateForum()"
      ></app-thread-form>
    </div>
  }
</div>
